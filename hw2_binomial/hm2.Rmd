---
title: "hw2_agr"
author: "Анастасия Костяницына"
output: html_document
---


### 1.1
```{r}
library(tidyverse)
library(mosaic)
 
df <- read_csv('https://raw.githubusercontent.com/agricolamz/2018_data_analysis_for_linguists/master/data/students/Stoneberry/hw2_binomial/hw2_binomial.csv')

binomial_test <- binom.test(x = df$k, n = df$n, p = df$prior)
binomial_test

```

### 1.2
```{r}
set.seed(42)
do(1000)*
  sum(sample(x = 1:0, 
             size = df$n, 
             prob = c(df$prior, 1-df$prior), 
             replace = TRUE)) ->
  simulations
simulations %>% 
  mutate(greater = sum >= df$k) %>% 
  count(greater)
```

### 1.3
```{r}

alpha_prior <-df$prior*df$n
beta_prior <-(1-df$prior)*df$n

alpha_data <- df$k
beta_data <- df$n - df$k

alpha_post <- alpha_prior + alpha_data
beta_post <- beta_prior + beta_data

alpha_post/(alpha_post+beta_post)

```

### 1.4
```{r}

alpha_prior <- 1
beta_prior <- 1

alpha_data <- df$k
beta_data <- df$n - df$k

alpha_post <- alpha_prior + alpha_data
beta_post <- beta_prior + beta_data

alpha_post/(alpha_post+beta_post)
```